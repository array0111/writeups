from cytro import *
from cytro.asym import *

e = 817721609
n1 = 3344010225055885973491588999363420613411075567840002461208569752004419741993174582138854670223166046674127107462753969521351209041939806446205365528011253050227927507918515346907421
n2 = 167663837533977947652081582045648125569032637295685094635986129360549681369715955646505025965127057736301986526279703324581893827662354605532428388334477513073162192776386280297520728983750276839384181312353678551770616865209200492259309228760849690065093528108282449736504274252376440992985163644236000365144116492405265270978369033380703887553818708433944493553330229125025921201973262826916716128644019251672645503789282363839133420932835820480998438891530495974651583236443139586689430408138372454185948962565094656129782407067033819085441504146333810443994773150900179010987008598289298403908549542437852114700336082026755085221963012072170665227206202133483671082936075762337823730785140313163052458895050298295245423
enc1 = 2498447944580074397436611474357081713121451516698669324969607078768944414253549070679159989595637056811680353013926796836708509558697664794440585361367292992920950732851115822225173
enc2 = 35448048389617156160682849392164208275342074454914069876560892813040616099079339814286150581899066495820575730718066006636138848738356353830999940216404197265207115973998454090310610905141339313547396493529943260724230070398766710347858566352629433583210636258749354582642754765143966026359984497014519291290499198307229518771480411120491918047601989827650234648591203307709862509041732327919759067907467099795582161193117027531612598653202446688646545045113643858120895991239602825842454839829602784051099092168118379253700902292083913283230873437094045953460622469888065314665694584230552142800768320443075473810587632849765814479162562198280760739094045014564834043782251297722923011483249190972488906149313123384316065
s,r = fermat_factorization(n1)

d1 = invmod(e,(r-1)*(s-1))
flag1 = n2s(pow(enc1,d1,n1))

p = r**4 + r**3 + r**2 + r +1
q = n2 // p 

assert n2 == p*q

d2 = invmod(e,(p-1)*(q-1))
flag2 = n2s(pow(enc2,d2,n2))

print(flag1+flag2)