## 03Else_1

```python
p = 12576521404814116418405527293372462493644446561744586896117484752900970475678321656709800103835040670074114354485616047706006446067458303134493822198866717
n2s(pow(c,invmod(e,p*(p-1)),n))
```
`Flag : sponge_bob_square_roots`

## 03Else_2

This challenge given two TwinPrime : p, p+2, q, q+2

$N_1 = pq$, $N_2 = (p+2)(q+2)$
$p = \frac{N_2}{q+2}-2$
$N_1 = (\frac{N_2}{q+2}-2)\dot q$
$N_1+2q = (\frac{N_2}{q+2})\dot q$
$(N_1+2q)(q+2) = qN_2$
$qN_1+2q**2+4q+2N_1 = qN_2$
$2q**2 + (N_1-N_2+4)q + 2N_1 = 0$

```python
from z3 import *
from libnum import *
p = Real('p')
q = Real('q')
n1 = 19402643768027967294480695361037227649637514561280461352708420192197328993512710852087871986349184383442031544945263966477446685587168025154775060178782897097993949800845903218890975275725416699258462920097986424936088541112790958875211336188249107280753661467619511079649070248659536282267267928669265252935184448638997877593781930103866416949585686541509642494048554242004100863315220430074997145531929128200885758274037875349539018669336263469803277281048657198114844413236754680549874472753528866434686048799833381542018876362229842605213500869709361657000044182573308825550237999139442040422107931857506897810951
n2 = 19402643768027967294480695361037227649637514561280461352708420192197328993512710852087871986349184383442031544945263966477446685587168025154775060178782897097993949800845903218890975275725416699258462920097986424936088541112790958875211336188249107280753661467619511079649070248659536282267267928669265252935757418867172314593546678104100129027339256068940987412816779744339994971665109555680401467324487397541852486805770300895063315083965445098467966738905392320963293379345531703349669197397492241574949069875012089172754014231783160960425531160246267389657034543342990940680603153790486530477470655757947009682859
e = 65537
c = 7991219189591014572196623817385737879027208108469800802629706564258508626010674513875496029177290575819650366802730803283761137036255380767766538866086463895539973594615882321974738140931689333873106124459849322556754579010062541988138211176574621668101228531769828358289973150393343109948611583609219420213530834364837438730411379305046156670015024547263019932288989808228091601206948741304222197779808592738075111024678982273856922586615415238555211148847427589678238745186253649783665607928382002868111278077054871294837923189536714235044041993541158402943372188779797996711792610439969105993917373651847337638929
solve(2*p**2 + (n1-n2+4)*p + 2*n1 == 0, n1 == p*q )
p = 109839168287920364771652233739542245893972429420400471787477887103169099491804762856071669374751286279860451783039232642710981517010937585802203565874477414469934412741906018847402147404957765188018616912003220542453809516059524224015255036266232001320821428611494617812180060212800300789614856560253120304701
q = 176645945799298135110721766377313792982812334295271987596634864064777954683139799946630491521527848390622912482826980130051166690303653228530141163053890146954290070312482492552495214917023922382112893625586133272913759418717134953590760109002220865007673751773346439753002517112721944238066505389966935631251
d1 = invmod(e,(p-1)*(q-1))
d2 = invmod(e,(p+1)*(q+1))

n2s(pow(pow(c,d2,n2),d1,n1))
```

`Flag : TWCTF{3102628d7059fa267365f8c37a0e56cf7e0797ef}`

## 03Else_3

```python
from Crypto.PublicKey import RSA
import base64 
from libnum import *

open('flag_b64d','wb').write(base64.b64decode(open('flag.enc'.'r').read()))
ns = []
for i in range(1,101):
    pub = RSA.importKey(open('{}.pem'.format(i),'r').read())
    ns.append(pub.n)

for i,n in enumerate(ns) :
    for j,n2 in enumerate(ns):
        if not gcd(n,n2) == 1 and n != n2:
            p = gcd(n,n2)
            priv = RSA.construct((n, pub.e, invmod(pub.e,(n//p-1)*(p-1))))
            open('{}.priv'.format(i),'wb').write(priv.exportKey())
```

This will trigger padding check failed ...

```bash
openssl rsautl -decrypt -in flag_b64d -out flag.txt -inkey 63.priv
openssl rsautl -decrypt -in flag_b64d -out flag.txt -inkey 86.priv
```

After tons of trying, RSA_OAEP!!!! The flag appear!!

```bash
openssl rsautl -decrypt -in flag_b64d -out flag.txt -inkey 63.priv -oaep
openssl rsautl -decrypt -in flag_b64d -out flag.txt -inkey 86.priv -oaep
```

`Flag : the_flag_is_b767b9d1fe02eb1825de32c6dacf4c2ef78c738ab0c498013347f4ea1e95e8fa`

## 03Else_3

```python
# Load public keys
ns = []
for i in range(0,100):
    pub = RSA.importKey(open('{}.pub'.format(i),'r').read())
    ns.append(pub.n)

# Extract the private keys
keys = []
for i,n in enumerate(ns) :
    for j,n2 in enumerate(ns):
        if not gcd(n,n2) == 1 and n != n2:
            p = gcd(n,n2)
            priv = RSA.construct((n, pub.e, invmod(pub.e,(n//p-1)*(p-1))))
            keys.append(priv)

# Find the right key
mes = set()
for key in keys:
    try:
        m = key.decrypt(flag)
        mes.add(m)
    except ValueError:
        pass
```
`Flag : ais3{Euc1id3an_a1g0ri7hm_i5_u53fu1}`
